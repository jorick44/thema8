---
title: "week 3"
author: "Pascal Visser"
date: "12-5-2021"
output: html_document
---

---- orgineel------
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Waarden.

| Symbool | Waarde             |
|---------|--------------------|
| mRNA~R~ | 4.74(fmol/g lever) |
| R       | 267(fmol/mg eiwit) |
| DR      | 0(fmol/mg eiwit)   |
| DR(N)   | 0(fmol/mg eiwit)   |

: initiale waarden.

| Symbool   | Waarde               |
|-----------|----------------------|
| k~s_Rm~   | 2.90(fmol/g lever/u) |
| IC~50_Rm~ | 26.2(fmol/mg eiwit)  |
| k~on~     | 0.00329(L/nmol/u)    |
| k~T~      | 0.63(u^-1^)          |
| k~re~     | 0.57(u^-1^)          |
| Rf        | 0.49(49%)            |
| k~d_R~    | 0.0572(u^-1^)        |
| k~d_Rm~   | 0.612(u^-1^)         |
| k~s_r~    | 3.22(u^-1^)          |
| D         | 53.409(nmol/L)       |

: parameters en waardes

```{r, Model, include=FALSE}
library(deSolve)
# Parameters
parameters <- c(ks_Rm = 2.90, # fmol/g liver/h
                IC50_Rm = 26.2, # fmol/mg protein
                kon = 0.00329, # L/nmol/h
                kT = 0.63, # 1/h
                kre = 0.57, # 1/h
                Rf = 0.49,
                kd_R = 0.0572, # 1/h
                kd_Rm = 0.612,
                ks_R = 3.22,
                D = 53.409) # nmol/L
# Initial state
state <- c(Rmo = 4.74, # fmol/g liver
           Ro = 267, # fmol/mg protein
           DR = 0, # fmol/ mg protein
           DRN = 0) # fmol/mg protein
# Model
GR <- function(t, state, parms){
  with(as.list(c(state, parms)),{
    dmRNAR <- ks_Rm * (1 - DRN/(IC50_Rm + DRN)) - kd_Rm * Rmo
    dR <- ks_R * Rmo + Rf * kre * DRN - kon * D * Ro - kd_R * Ro
    dDR <- kon * D * Ro - kT * DR
    dDRN <- kT * DR - kre * DRN
    return(list(c(dmRNAR, dR, dDR, dDRN)))
  })}
# Timeframe
times <- seq(0, 48, by = 1)
# Run model
out <- ode(y = state, times = times, parms = parameters, func = GR, method = "euler")
```

# Results.

```{r, plotting, echo=FALSE}
# Plot
plot(out, main = c("Level of receptor mRNA", "Level of free receptors",
                   "Densety of MPL-receptor complex", "Number of MPL-complexes\nin the nucleous"),
     xlab = "time in hours",
     ylab = c("fmol/g liver", "fmol/mg protein", "fmol/mg protein", "fmol/mg protein"))
``` 

# Questions:

## 1 
What would be the time course concentration of the activated drug-receptor complex if there was no auto-regulation of glucocorticoid receptor, i.e. if there was not effect of drug on the synthesis of the receptor mRNA? What formula needs to be changed? Adjust the model, run the simulation and plot the results to find out.

Door de auto regulatie uit te schakelen, kan er ongeremt synthese plaats vinden van het receptor mRNA. in de formule [ks_Rm * (1 - DRN/(IC50_Rm + DRN)) - kd_Rm * Rmo], wordt het deel van de auto regulatie door de IC50_rm verwijderd. dit geeft de volgende nieuwe formule Ks_rm - kd_rm * Rmo. door deze verandering door te voeren zien de plots er als volgt uit:

```{r}
GR <- function(t, state, parms){
  with(as.list(c(state, parms)),{
    dmRNAR <- ks_Rm - kd_Rm * Rmo
    dR <- ks_R * Rmo + Rf * kre * DRN - kon * D * Ro - kd_R * Ro
    dDR <- kon * D * Ro - kT * DR
    dDRN <- kT * DR - kre * DRN
    return(list(c(dmRNAR, dR, dDR, dDRN)))
  })}

out <- ode(y = state, times = times, parms = parameters, func = GR, method = "euler")

# Plot
plot(out, main = c("Level of receptor mRNA", "Level of free receptors",
                   "Densety of MPL-receptor complex", "Number of MPL-complexes\nin the nucleous"),
     xlab = "time in hours",
     ylab = c("fmol/g liver", "fmol/mg protein", "fmol/mg protein", "fmol/mg protein"))

```
Doordat de autoregulatie nu uitgeschakelt is, trekt het niveau van het receptor mRNA naar 0 toe. hierdoor stagneert de aanmaakt van nieuwe MRA.

## 2
What is the time course of receptor and mRNA concentrations when the drug treatment is stopped? So After the steady state is reached (at time t_steady), D should be set to zero and the simulation should continue from time t_steady till the new steady state is reached (t_steady_second). Run the simulations and plot the results from t = 0 till t_steady_second.

Na een x aantal uren bereikt de receptor mRNA en vrije receptor concentratie een evenwicht, er komt niet meer mRNA of vrije receptor bij en er wordt niks afgebroken. Nu wordt er gekeken, wat gebeurt er als de toevoeging van het medicijn stopt. Hiervoor wordt een tweede tijdsequentie toegevoegd, waarin de D (concentratie van MPL in nmol/L) op 0 wordt gezet. Deze nieuwe tijdssequentie wordt aan de eerste tijdssequentie geplakt. 

```{r}
GR <- function(t, state, parms){
  with(as.list(c(state, parms)),{
    dmRNAR <- ks_Rm * (1 - DRN/(IC50_Rm + DRN)) - kd_Rm * Rmo
    dR <- ks_R * Rmo + Rf * kre * DRN - kon * D * Ro - kd_R * Ro
    dDR <- kon * D * Ro - kT * DR
    dDRN <- kT * DR - kre * DRN
    return(list(c(dmRNAR, dR, dDR, dDRN)))
  })}

# Observation time series (using function seq)
Times  <-seq(0,24*2,by=1)
Times2 <- seq(0,24*3,by=1)

para_after <- replace(parameters, 10, 0)

out1 <- ode(y = state, times = Times, parms = parameters, func = GR, method = "euler")
out2 <- ode(y=out1[length(Times),2:5], times=Times2, parms= para_after, func = GR, method = "euler")

out2[,1] <- out2[,1]+Times[length(Times)]

out_n <- rbind(out1,out2)

# Convert output to dataframe for easy post-processing using $ notation
out_r<-as.data.frame(out_n)

# Make plot of concentration of receptor mRNa and free receptor density
par(mfrow=c(1,2))
plot(out_r$time,out_r$Rm,ylim = c(1,5), xlab="Time",ylab="receptor mRNA",type="l",lwd=2)
plot(out_r$time,out_r$Ro, ylim = c(0,500), xlab="Time",ylab="free receptor density",type="l",lwd=2)
```

Er is duidelijk te zien dat het stoppen van de toevoeging van medicijn een sterk effect heeft. Zowel de concentratie receptor mRNA als vrije receptoren stijgt sterkt na het ontbreken van het medicijn. Door dat er geen medicijn aanwezig is worden de mRNA's niet meer getransleerd en worden de vrije receptoren ook niet meer verbruikt.

## 3
Different corticosteroids show different association rates from receptors (kon) and different dissociation rates (in this model reflected by kre). Assuming the same concentrations of the drug, what is the effect of different values of kon and kre (consider 2 and 5 times increase and decrease of both parameters separately) on the receptor and mRNA dynamics? Adjust kon and kre as below and plot the results of the simulation for each change. Note: Simulations should be run for 4 new values of kon: 0.00329/5, 0.00329/2, 0.00329*2 and 0.00329*5. The results should be compared to the basic scenario when kon=0.00329 Separately, simulations should be run for 4 new values of kre: 0.57/5, 0.57/2, 0.57*2 and 0.57*5. The results should be compared to the basic scenario when kre= 0.57.

Verschillende corticosteroÃ¯den laten verschillende stijgingen en dalingen zien van K~on (snelheidsconstante voor de vorming van MPL-receptor (nmol/L/u)) en K~re (snelheidsconstante voor het herstel van MPL-receptor complexen uit de celkern per uur).Er wordt gekeken wat het effect is op de receptor en mRNA dynamica. Er wordt bij K~on en K~re gekeken naar een toename van 2 en 5, en een vermindering van 2 en 5 keer. 

```{r}
# Model
GR <- function(t, state, parms){
  with(as.list(c(state, parms)),{
    dmRNAR <- ks_Rm * (1 - DRN/(IC50_Rm + DRN)) - kd_Rm * Rmo
    dR <- ks_R * Rmo + Rf * kre * DRN - kon * D * Ro - kd_R * Ro
    dDR <- kon * D * Ro - kT * DR
    dDRN <- kT * DR - kre * DRN
    return(list(c(dmRNAR, dR, dDR, dDRN)))
  })}

# Initial state
state <- c(Rmo = 4.74, # fmol/g liver
           Ro = 267, # fmol/mg protein
           DR = 0, # fmol/ mg protein
           DRN = 0) # fmol/mg protein

# Observation time series (using function seq)
ObservationTimes<-seq(0,24*2,by=1)

factors <- c(1/5,1/2,1,2,5)

# Load model parameters
MyParms_kon<-cbind(
  ks_Rm=rep(2.9,times=length(factors)),
  IC50_Rm=rep(26.2,times=length(factors)),
  kon=0.00329*factors,
  kT=rep(0.63,times=length(factors)),
  kre=rep(0.57,times=length(factors)),
  Rf=rep(0.49,times=length(factors)),
  kd_R=rep(0.0572,times=length(factors)),
  kd_Rm=rep(0.612,times=length(factors)),
  ks_R=rep(3.22,times=length(factors)),
  D=rep(20*1000/374.471,times=length(factors))
)

MyParms_kre<-cbind(
  ks_Rm=rep(2.9,times=length(factors)),
  IC50_Rm=rep(26.2,times=length(factors)),
  kon=rep(0.00329,times=length(factors)),
  kT=rep(0.63,times=length(factors)),
  kre=0.57*factors,
  Rf=rep(0.49,times=length(factors)),
  kd_R=rep(0.0572,times=length(factors)),
  kd_Rm=rep(0.612,times=length(factors)),
  ks_R=rep(3.22,times=length(factors)),
  D=rep(20*1000/374.471,times=length(factors))
  )

# simulations for different kon

for (i in 1:length(factors)){
# call lsoda and store result in out
  out <- ode(
    y=state, 
    times=ObservationTimes,   							
    func=GR, 
    parms=MyParms_kon[i,]
  )  
  # Convert output to dataframe for easy post-processing using $ notation
  out<-as.data.frame(out)
  out$kon <- MyParms_kon[i,c("kon")]
  
  if (i>1)
   {  
       simset_kon<-rbind(simset_kon,out)
   }
   else
   {
       simset_kon<-out
   }
}



# simulations for different kre

for (i in 1:length(factors)){
# call lsoda and store result in out
  out <- ode(
     y=state, 
     times=ObservationTimes,     						
    func=GR, 
    parms=MyParms_kre[i,]
  )  
  # Convert output to dataframe for easy post-processing using $ notation
  out<-as.data.frame(out)
  out$kre <- MyParms_kre[i,c("kre")]
  
  if (i>1)
   {  
       simset_kre<-rbind(simset_kre,out)
   }
   else
   {
       simset_kre<-out
   }
}



# Make plots of concentration of receptor mRNa and free receptor density
par(mfrow=c(1,2))
  plot(simset_kon$time[simset_kon$kon==MyParms_kon[1,c("kon")]],simset_kon$Rm[simset_kon$kon==MyParms_kon[1,c("kon")]],ylim = c(0,5), xlab="Time",ylab="receptor mRNA", main = 'Kon', type="l",lwd=2, col="orange")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[2,c("kon")]],simset_kon$Rm[simset_kon$kon==MyParms_kon[2,c("kon")]],ylim = c(0,5), type="l",lwd=2, col="red")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[3,c("kon")]],simset_kon$Rm[simset_kon$kon==MyParms_kon[3,c("kon")]],ylim = c(0,5), type="l",lwd=2, col="black")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[4,c("kon")]],simset_kon$Rm[simset_kon$kon==MyParms_kon[4,c("kon")]],ylim = c(0,5), type="l",lwd=2, col="darkblue")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[5,c("kon")]],simset_kon$Rm[simset_kon$kon==MyParms_kon[5,c("kon")]],ylim = c(0,5), type="l",lwd=2, col="lightblue")

  plot(simset_kon$time[simset_kon$kon==MyParms_kon[1,c("kon")]],simset_kon$Ro[simset_kon$kon==MyParms_kon[1,c("kon")]], ylim = c(0,300), xlab="Time",ylab="free receptor density",main = 'Kon',type="l",lwd=2, col="orange")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[2,c("kon")]],simset_kon$Ro[simset_kon$kon==MyParms_kon[2,c("kon")]], ylim = c(0,300), type="l",lwd=2, col="red")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[3,c("kon")]],simset_kon$Ro[simset_kon$kon==MyParms_kon[3,c("kon")]], ylim = c(0,300), type="l",lwd=2, col="black")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[4,c("kon")]],simset_kon$Ro[simset_kon$kon==MyParms_kon[4,c("kon")]], ylim = c(0,300), type="l",lwd=2, col="darkblue")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[5,c("kon")]],simset_kon$Ro[simset_kon$kon==MyParms_kon[5,c("kon")]], ylim = c(0,300), type="l",lwd=2, col="lightblue")

  plot(simset_kon$time[simset_kon$kon==MyParms_kon[1,c("kon")]],simset_kon$DR[simset_kon$kon==MyParms_kon[1,c("kon")]], ylim = c(0,130), xlab="Time",ylab="drug-receptor complex",main = 'Kon',type="l",lwd=2, col="orange")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[2,c("kon")]],simset_kon$DR[simset_kon$kon==MyParms_kon[2,c("kon")]], ylim = c(0,130), type="l",lwd=2, col="red")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[3,c("kon")]],simset_kon$DR[simset_kon$kon==MyParms_kon[3,c("kon")]], ylim = c(0,130), type="l",lwd=2, col="black")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[4,c("kon")]],simset_kon$DR[simset_kon$kon==MyParms_kon[4,c("kon")]], ylim = c(0,130), type="l",lwd=2, col="darkblue")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[5,c("kon")]],simset_kon$DR[simset_kon$kon==MyParms_kon[5,c("kon")]], ylim = c(0,130), type="l",lwd=2, col="lightblue")

  plot(simset_kon$time[simset_kon$kon==MyParms_kon[1,c("kon")]],simset_kon$DRN[simset_kon$kon==MyParms_kon[1,c("kon")]], ylim = c(0,100), xlab="Time",ylab="activated drug-receptor complex",main = 'Kon',type="l",lwd=2, col="orange")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[2,c("kon")]],simset_kon$DRN[simset_kon$kon==MyParms_kon[2,c("kon")]], ylim = c(0,100), type="l",lwd=2, col="red")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[3,c("kon")]],simset_kon$DRN[simset_kon$kon==MyParms_kon[3,c("kon")]], ylim = c(0,100), type="l",lwd=2, col="black")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[4,c("kon")]],simset_kon$DRN[simset_kon$kon==MyParms_kon[4,c("kon")]], ylim = c(0,100), type="l",lwd=2, col="darkblue")
  lines(simset_kon$time[simset_kon$kon==MyParms_kon[5,c("kon")]],simset_kon$DRN[simset_kon$kon==MyParms_kon[5,c("kon")]], ylim = c(0,100), type="l",lwd=2, col="lightblue")

# Make plots of concentration of receptor mRNa and free receptor density
par(mfrow=c(1,2))
  plot(simset_kre$time[simset_kre$kre==MyParms_kre[1,c("kre")]],simset_kre$Rm[simset_kre$kre==MyParms_kre[1,c("kre")]],ylim = c(0,5), xlab="Time",ylab="receptor mRNA",main = 'Kre',type="l",lwd=2, col="orange")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[2,c("kre")]],simset_kre$Rm[simset_kre$kre==MyParms_kre[2,c("kre")]],ylim = c(0,5), type="l",lwd=2, col="red")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[3,c("kre")]],simset_kre$Rm[simset_kre$kre==MyParms_kre[3,c("kre")]],ylim = c(0,5), type="l",lwd=2, col="black")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[4,c("kre")]],simset_kre$Rm[simset_kre$kre==MyParms_kre[4,c("kre")]],ylim = c(0,5), type="l",lwd=2, col="darkblue")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[5,c("kre")]],simset_kre$Rm[simset_kre$kre==MyParms_kre[5,c("kre")]],ylim = c(0,5), type="l",lwd=2, col="lightblue")

  plot(simset_kre$time[simset_kre$kre==MyParms_kre[1,c("kre")]],simset_kre$Ro[simset_kre$kre==MyParms_kre[1,c("kre")]], ylim = c(0,300), xlab="Time",ylab="free receptor density",main = 'Kre',type="l",lwd=2, col="orange")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[2,c("kre")]],simset_kre$Ro[simset_kre$kre==MyParms_kre[2,c("kre")]], ylim = c(0,300), type="l",lwd=2, col="red")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[3,c("kre")]],simset_kre$Ro[simset_kre$kre==MyParms_kre[3,c("kre")]], ylim = c(0,300), type="l",lwd=2, col="black")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[4,c("kre")]],simset_kre$Ro[simset_kre$kre==MyParms_kre[4,c("kre")]], ylim = c(0,300), type="l",lwd=2, col="darkblue")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[5,c("kre")]],simset_kre$Ro[simset_kre$kre==MyParms_kre[5,c("kre")]], ylim = c(0,300), type="l",lwd=2, col="lightblue")

  plot(simset_kre$time[simset_kre$kre==MyParms_kre[1,c("kre")]],simset_kre$DR[simset_kre$kre==MyParms_kre[1,c("kre")]], ylim = c(0,60), xlab="Time",ylab="drug-receptor complex",main = 'Kre',type="l",lwd=2, col="orange")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[2,c("kre")]],simset_kre$DR[simset_kre$kre==MyParms_kre[2,c("kre")]], ylim = c(0,60), type="l",lwd=2, col="red")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[3,c("kre")]],simset_kre$DR[simset_kre$kre==MyParms_kre[3,c("kre")]], ylim = c(0,60), type="l",lwd=2, col="black")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[4,c("kre")]],simset_kre$DR[simset_kre$kre==MyParms_kre[4,c("kre")]], ylim = c(0,60), type="l",lwd=2, col="darkblue")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[5,c("kre")]],simset_kre$DR[simset_kre$kre==MyParms_kre[5,c("kre")]], ylim = c(0,60), type="l",lwd=2, col="lightblue")

  plot(simset_kre$time[simset_kre$kre==MyParms_kre[1,c("kre")]],simset_kre$DRN[simset_kre$kre==MyParms_kre[1,c("kre")]], ylim = c(0,130), xlab="Time",ylab="activated drug-receptor complex",main = 'Kre',type="l",lwd=2, col="orange")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[2,c("kre")]],simset_kre$DRN[simset_kre$kre==MyParms_kre[2,c("kre")]], ylim = c(0,130), type="l",lwd=2, col="red")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[3,c("kre")]],simset_kre$DRN[simset_kre$kre==MyParms_kre[3,c("kre")]], ylim = c(0,130), type="l",lwd=2, col="black")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[4,c("kre")]],simset_kre$DRN[simset_kre$kre==MyParms_kre[4,c("kre")]], ylim = c(0,130), type="l",lwd=2, col="darkblue")
  lines(simset_kre$time[simset_kre$kre==MyParms_kre[5,c("kre")]],simset_kre$DRN[simset_kre$kre==MyParms_kre[5,c("kre")]], ylim = c(0,130), type="l",lwd=2, col="lightblue")
```
Uit de grafieken is op te maken dat een vermeerdering of vermindering van de concentratie K~on of K~re een duidelijk effect heeft. al kan worden geconcludeerd dat de K~re verandering voor meer veranderingen zorgt dan de K~on.

## 4
What would happen if the synthesis of the receptor was completely blocked? Which parameter needs to be put to zero? Adjust the parameter, run the simulations and plot the results.

wat gebeurt er als de synthese van de receptor op 0 wordt gezet? Hiervoor wordt de ks_r parameter veranderd naar 0:

```{r}
para_alt <- replace(parameters, 9, 0)

out <- ode(y = state, times = times, parms = para_alt, func = GR, method = "euler")

# Plot
plot(out, main = c("Level of receptor mRNA", "Level of free receptors",
                   "Densety of MPL-receptor complex", "Number of MPL-complexes\nin the nucleous"),
     xlab = "time in hours",
     ylab = c("fmol/g liver", "fmol/mg protein", "fmol/mg protein", "fmol/mg protein"))
```
door de aanmaak van de receptor op 0 te zetten wordt de grafiek van het receptor mRNA het meeste aangetast. na de daling, herstelt deze zich sterk met een stijging naar het oude niveau.

## 5
What is the dynamic of the system when the baseline rate of production of mRNA of the receptor is increased or decreased 2 or 5 fold (recalculate the rate of mRNA degradation so that the steady-state assumption at baseline (without the drug) is still valid, i.e. mRNA levels are constant when there is not drug)? Mind you: ks_Rm values should be changed, but we know that if without the drug the system is at steady-state then kd_Rm = ks_Rm/Rm0. Therefore if we change ks_Rm we need to change kd_Rm as well. Also after we recalculate the value of kd_Rm for the baseline conditions, the simulations should be run with drug present. Simulations should be run for 4 different scenarios:
ks_Rm = 2.9/5 and kd_Rm=2.9/5/4.74
ks_Rm = 2.9/2 and kd_Rm=2.9/2/4.74
ks_Rm = 2.9*2 and kd_Rm=2.9*2/4.74
ks_Rm = 2.9*5 and kd_Rm=2.9*5/4.74


Wat is de dynamiek van het systeem wanneer de basis snelheid van de mRNA productie in verhoogd of verlaagd?

```{r}
fifthGenerationModel <- function(t, x, parms) 
{
  Rm <- x[1]           # mRNA for the receptor
  R <- x[2]           # receptor density
  DR <- x[3]           # drug-receptor comples
  DRN <- x[4]         # nuclear activated drug-receptor complex
  
  with(as.list(parms),
  {
     dRm <- ksyn_rm*(1-DRN/(IC50 + DRN)) - kdgr_rm*Rm
     dR <- ksyn_r*Rm + rf*kre*DRN - kon*D*R - kdgr_r*R
     dDR <- kon*D*R - kt*DR
     dDRN <- kt*DR - kre*DRN
 
     # store results in res
     res<-c(dRm,dR,dDR,dDRN)
     list(res)
  })
}

# Observation time series (using function seq)
ObservationTimes<-seq(0,24*2,by=1)

factors <- c(1/5,1/2,1,2,5)
ksyn_rm=2.9*factors
kdgr_rm=ksyn_rm/4.74

# Load model parameters
MyParms_ksyn_rm<-cbind(
  ksyn_rm=ksyn_rm,
  IC50=rep(26.2,times=length(factors)),
  kon=rep(0.00329,times=length(factors)),
  kt=rep(0.63,times=length(factors)),
  kre=rep(0.57,times=length(factors)),
  rf=rep(0.49,times=length(factors)),
  kdgr_r=rep(0.0572,times=length(factors)),
  kdgr_rm=kdgr_rm,
  ksyn_r=rep(3.22,times=length(factors)),
  D=rep(20*1000/374.471,times=length(factors))   #(20/374.471)*1000
)


# simulations for different ksyn_rm

for (i in 1:length(factors)){
# call lsoda and store result in out
  out <- ode(
      y=state, 
     times=ObservationTimes,   							
    func=fifthGenerationModel, 
    parms=MyParms_ksyn_rm[i,]
  )  
  # Convert output to dataframe for easy post-processing using $ notation
  out<-as.data.frame(out)
  out$ksyn_rm <- MyParms_ksyn_rm[i,c("ksyn_rm")]
  
  if (i>1)
   {  
       simset_ksyn_rm<-rbind(simset_ksyn_rm,out)
   }
   else
   {
       simset_ksyn_rm<-out
   }
}

# Make plots of concentration of receptor mRNa and free receptor density
par(mfrow=c(1,2))
  plot(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]],simset_ksyn_rm$Rm[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]],ylim = c(0,5), xlab="Time",ylab="receptor mRNA",main ="Rmo", type="l",lwd=2, col="orange")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]],simset_ksyn_rm$Rm[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]],ylim = c(0,5), type="l",lwd=2, col="red")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]],simset_ksyn_rm$Rm[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]],ylim = c(0,5), type="l",lwd=2, col="black")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]],simset_ksyn_rm$Rm[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]],ylim = c(0,5), type="l",lwd=2, col="darkblue")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]],simset_ksyn_rm$Rm[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]],ylim = c(0,5), type="l",lwd=2, col="lightblue")

  plot(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]],simset_ksyn_rm$Ro[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]], ylim = c(0,300), xlab="Time",ylab="free receptor density",main = "Ro", type="l",lwd=2, col="orange")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]],simset_ksyn_rm$Ro[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]], ylim = c(0,300), type="l",lwd=2, col="red")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]],simset_ksyn_rm$Ro[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]], ylim = c(0,300), type="l",lwd=2, col="black")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]],simset_ksyn_rm$Ro[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]], ylim = c(0,300), type="l",lwd=2, col="darkblue")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]],simset_ksyn_rm$Ro[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]], ylim = c(0,300), type="l",lwd=2, col="lightblue")

  plot(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]],simset_ksyn_rm$DR[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]], ylim = c(0,60), xlab="Time",ylab="drug-receptor complex",main = "DR", type="l",lwd=2, col="orange")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]],simset_ksyn_rm$DR[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="red")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]],simset_ksyn_rm$DR[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="black")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]],simset_ksyn_rm$DR[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="darkblue")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]],simset_ksyn_rm$DR[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="lightblue")

  plot(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]],simset_ksyn_rm$DRN[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[1,c("ksyn_rm")]], ylim = c(0,60), xlab="Time",ylab="activated drug-receptor complex",main = "DRN", type="l",lwd=2, col="orange")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]],simset_ksyn_rm$DRN[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[2,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="red")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]],simset_ksyn_rm$DRN[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[3,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="black")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]],simset_ksyn_rm$DRN[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[4,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="darkblue")
  lines(simset_ksyn_rm$time[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]],simset_ksyn_rm$DRN[simset_ksyn_rm$ksyn_rm==MyParms_ksyn_rm[5,c("ksyn_rm")]], ylim = c(0,60), type="l",lwd=2, col="lightblue")
```
Het aantal receptor mRNA wordt het meeste aangetast door de veranderende basis snelheid, bij een toe of afname wordt in alle gevallen de concentratie receptor mRNA verlaagd. 




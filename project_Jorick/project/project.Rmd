---
title: "Project"
author: "Jorick Baron, Pascal Visser"
date: "5/26/2021"
output: pdf_document
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(deSolve)
```

# model

Here is a model of the virus's interaction with Human Small Airway Epithelial Cells (HSAEC). Based upon a modified version of the base model @benedict2015 where we added a viral decay parameter to simulate it closer to reality based upon Handel's influenza model @Handel2010 . Used here are the standard situation (no drugs) parameters and values, displayed in this table.

| Symbol | Value                  |
|--------|------------------------|
| g      | 0.742 \* 10^-3^ h^-1^  |
| b      | 0.195 h^-1^ U^-1^      |
| l      | $1/4$ h^-1^            |
| d      | 0.0222 h^-1^           |
| p      | 0.531 h^-1^            |
| vd     | 2.4 h^-1^ (10/day)     |
| U(0)   | 1.34 \* 10^5^ HSAEC/ml |
| E(0)   | 3.34 \* 10^4^ HSAEC/ml |
| I(0)   | 0 HSAEC/ml             |
| V(0)   | 0 PFU/ml               |

: standard parameters and values

```{r}
# Parameters
parameters <- c(g = 0.742 * 10^-3, # h^-1
                b = 0.195, # h^-1 U^-1
                l = 1/4, # h^-1
                d = 0.0222, # h^-1
                p = 0.531, # h^-1
                vd = 2.4
                ) 

# Initial state
state <- c(U = 1.34 * 10^5, # HSAEC/ml
           E = 3.34 * 10^4, # HSAEC/ml
           I = 0, # HSAEC/ml
           V = 0, # PFU/ml
           D = 0
           ) 
# Model
viral <- function(t, y, parms){
  with(as.list(c(parms)),{
    dU <- g * y[5] - b * y[1] * y[4]
    dE <- b * y[1] * y[4] - l * y[2]
    dI <- l * y[2] - d * y[3]
    dV <- p * y[3] - b * y[1] * y[4] - vd *y[4]
    dD <- d * y[3]  - g * y[5] 
    return(list(c(dU, dE, dI, dV, dD)))
  })}
# Timeframe
times <- seq(0, 30, by = 1)
# Run model
viralout <- lsoda(y = state,
                  times = times,
                  parms = parameters,
                  func = viral)
# Clean up data
viralout <- data.frame(viralout)
row.names(viralout) <- viralout$time
viralout[,5] <- viralout[,5] -700 
vir <- viralout
viralout <- viralout[2:6]
viralout <- apply(viralout, 2, log10)
viralout[is.na(viralout) | is.infinite(viralout) | viralout < 0] <- 0

#plot
par(mfrow=c(2,2))
#1
plot(viralout[,1], main = "Uninfected cells",
     xlab = "Time(hpi)", ylab = "log10(HSAEC/ml)",
     ylim = c(0, 7), type = "l", col = "green")
#2
plot(viralout[,2], main = "Early infected cells",
     xlab = "Time(hpi)", ylab = "log10(HSAEC/ml)",
     ylim = c(0, 7), type = "l", col = "orange")
#3
plot(viralout[,3], main = "Infected cells",
     xlab = "Time(hpi)", ylab = "log10(HSAEC/ml)",
     ylim = c(0, 7), type = "l", col = "red")
#4
plot(viralout[,4], main = "Virus numbers",
     xlab = "Time(hpi)", ylab = "log10(PFU/ml)",
     ylim = c(0, 7), type = "l")
par(mfrow=c(1,1))
#5 
plot(viralout[,5], main = "Dead Cells",
     xlab = "Time(hpi)", ylab = "log10(HSAE/ml)",
     ylim = c(0, 7), type = "l")
```
